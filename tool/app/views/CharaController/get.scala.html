@(id: String, chara: Option[model.Chara], races: List[model.Race], classes: List[model.Class])(implicit helper: models.ModelHelper)

@main(title = "/characters/" + id) {

    @if(chara.isEmpty) {
        <div class="row">
            <div class="col-xs-12">
                <div class="page-header">
                    <h1>/characters/@id not found</h1>
                </div>
            </div>
        </div>
    }

    @for(c <- chara) {
        <div class="row">
            <div class="col-xs-12">
                <div class="page-header">
                    <h1>/characters/@id</h1>
                </div>

                @component.table.characters(c :: Nil) {
                    <tr>
                        <td></td>
                        <td>@component.form.name(default = c.name)</td>
                        <td>@component.form.race(races = races, default = c.getRace)</td>
                        <td>@component.form.classes(classes = classes, default = c.classes.map(_.getId).toSet)</td>
                    </tr>
                }
            </div>

            <div id="update-result"></div>

            <button id="update" type="button" class="btn btn-default">Update</button>
            <button id="delete" type="button" class="btn btn-danger">Delete</button>
        </div>

        <script>
            $('#update').click(function() {
                var url = window.location.origin + '@routes.CharaController.update';

                var body = {
                    'id': '@id',
                    'name': nameValue(),
                    'race': raceValue(),
                    'classes': classesValue()
                };

                jsonApi(url, 'PUT', body, '#update-result');
            });

            $('#delete').click(function() {
                var url = window.location.origin + '@routes.CharaController.delete(id)';

                noContentApi(url, 'DELETE', '#update-result');
            });
        </script>

        <div class="row">
            <div class="col-xs-12">
                <form class="form-inline">
                    <div class="input-group">
                        <input type="number" class="form-control" id="xp" value="0">
                        <div class="input-group-addon">xp</div>
                    </div>
                    <button id="gain-xp" type="button" class="btn btn-default">Gain Xp</button>
                </form>
            </div>
        </div>

        <script>
            $('#gain-xp').click(function() {
                var url = window.location.origin + '@routes.CharaController.gainXp(id)';

                var body = {'xp': number('#xp')};

                jsonApi(url, 'POST', body, '#update-result');
            });
        </script>
    }
}
