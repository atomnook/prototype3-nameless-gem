@(id: String, chara: Option[model.Chara])(implicit helper: models.ModelHelper)

@import helper._

@tnl(level: model.CharaLevel) = { @(domain.formula.TilNextLevel(level.level + 1).xp - level.xp) }

@main(title = "/characters/" + id) {
@if(chara.isEmpty) {
<div class="row">
    <div class="col-xs-12">
        <div class="page-header">
            <h1>/characters/@id not found</h1>
        </div>
    </div>
</div>
}
@for(c <- chara) {
<div class="row">
    <div class="col-xs-12">
        <div class="page-header">
            <h1>/characters/@id</h1>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-xs-6">
        <div id="update-result"></div>
    </div>
</div>
<div class="row">
    <div class="col-xs-6">
        <dl class="dl-horizontal">
            <dt>Id</dt><dd>@id</dd>
            <dt>Name</dt><dd>@c.name</dd>

            <dt>Race</dt>
            <dd>
                @c.getRace.name L@c.getRaceLevel.level<br/>
                @c.getRaceLevel.xp xp, @tnl(c.getRaceLevel) til next level, @c.getRaceLevel.cp cp
            </dd>

            @for(cls <- c.classes.zipWithIndex) {
            <dt>Class[@cls._2]</dt>
            <dd>
                @cls._1.getId.name L@cls._1.getLevel.level<br/>
                @cls._1.getLevel.xp xp, @tnl(cls._1.getLevel) til next level, @cls._1.getLevel.cp cp
            </dd>
            }
        </dl>
    </div>
    <div class="col-xs-6">
        <form class="form-inline">
            <div class="form-group">
                <div class="input-group">
                    <input type="number" class="form-control" id="xp" placeholder="0">
                    <div class="input-group-addon">xp</div>
                </div>
            </div>
            <div class="form-group">
                <button id="gain-xp" type="button" class="btn btn-default">Gain Xp</button>
            </div>
        </form>
    </div>
</div>
<div class="row">
    <div class="col-xs-6">
        <form>
            <button id="delete" type="button" class="btn btn-danger">Delete</button>
        </form>
    </div>
</div>
}
<script>
    $('#gain-xp').click(function() {
        var url = window.location.origin + '@routes.CharaController.gainXp(id)';
        var xp = parseInt($('#xp').val());

        jsonApi(url, 'POST', {'xp': xp}, '#update-result');
    });

    $('#delete').click(function() {
        var url = window.location.origin + '@routes.CharaController.delete(id)';

        noContentApi(url, 'DELETE', '#update-result');
    });
</script>
}
